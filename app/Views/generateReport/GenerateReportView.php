<section id="maincontent" class="w-full h-full overflow-y-auto flex justify-center flex-col items-center">
    <link rel="stylesheet" href="<?= base_url() ?>css/xspreadsheet.css">
    <div id="x-spreadsheet-demo"></div>
    
    <div class="mt-4 flex space-x-4">
        <button id="saveButton" class="px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-700 focus:outline-none">Save</button>
        <button id="partialSaveButton" class="px-2 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-700 focus:outline-none">Partial Save</button>
    </div>


</section>

<script src="<?= base_url() ?>js/xspreadsheet.js"></script>
<script>
    $(document).ready(function () {
        
        const sheetData = <?php echo json_encode($sheetData); ?>;
    console.log(sheetData);

        try {
            const spreadsheet = x_spreadsheet('#x-spreadsheet-demo', {
                mode: 'edit', 
                showToolbar: true,
                showGrid: true, 
                showContextmenu: true,
                view: {
                    height: () => $('#maincontent').height() - 55,
                    width: () => $('#maincontent').width(),
                },
                row: {
                    len: 100, 
                    height: 25, 
                },
                col: {
                    len: 26, 
                    width: 100,
                    indexWidth: 60,
                    minWidth: 60, 
                },
                style: {
                    bgcolor: '#ffffff', 
                    align: 'left', 
                    valign: 'middle', 
                    textwrap: false,
                    strike: false,
                    underline: false,
                    color: '#0a0a0a',
                    font: {
                        name: 'Helvetica',
                        size: 10,
                        bold: false,
                        italic: false,
                    },
                },
            });

            
            spreadsheet.loadData({
                "name":"sheet2","freeze":"A1","styles":[{"align":"center"},{"align":"center","valign":"middle"},{"align":"center","valign":"middle","font":{"bold":true}},{"bgcolor":"#2e75b5"},{"bgcolor":"#2e75b5","font":{"bold":true}},{"font":{"bold":true}},{"bgcolor":"#2e75b5","font":{"bold":true,"size":16}},{"font":{"bold":true,"size":16}},{"bgcolor":"#2e75b5","font":{"bold":true,"size":16},"color":"#ffffff"},{"font":{"bold":true,"size":16},"color":"#ffffff"},{"bgcolor":"#2e75b5","align":"center"},{"bgcolor":"#2e75b5","font":{"bold":true,"size":16},"color":"#ffffff","align":"center"},{"font":{"bold":true,"size":16},"color":"#ffffff","align":"center"},{"bgcolor":"#2e75b5","align":"center","color":"#ffffff"},{"align":"center","color":"#ffffff"},{"bgcolor":"#2e75b5","color":"#ffffff"},{"color":"#ffffff"},{"bgcolor":"#ad2177","font":{"bold":true,"size":16},"color":"#ffffff","align":"center"},{"bgcolor":"#ad2177"},{"bgcolor":"#ad2177","align":"center","color":"#ffffff"},{"color":"#ffffff","bgcolor":"#ad2177"},{"bgcolor":"#ad2177","align":"center"},{"bgcolor":"#ad2177","align":"center","border":{"bottom":["thin","#000"],"top":["thin","#000"],"left":["thin","#000"],"right":["thin","#000"]}},{"bgcolor":"#ad2177","font":{"size":14}},{"bgcolor":"#ad2177","font":{"size":12}},{"bgcolor":"#ad2177","font":{"size":12},"color":"#ffffff"},{"bgcolor":"#ad2177","font":{"size":12},"color":"#ffffff","align":"center"},{"bgcolor":"#ad2177","font":{"size":14},"color":"#ffffff"},{"bgcolor":"#ad2177","font":{"size":14},"color":"#ffffff","align":"center"},{"align":"center","valign":"middle","bgcolor":"#ad2177"},{"align":"center","valign":"middle","bgcolor":"#ad2177","color":"#ffffff"},{"align":"center","valign":"middle","bgcolor":"#ad2177","color":"#ffffff","textwrap":true},{"align":"center","valign":"middle","bgcolor":"#ad2177","color":"#ffffff","textwrap":true,"font":{"size":12}},{"align":"center","valign":"middle","bgcolor":"#ad2177","color":"#ffffff","textwrap":true,"font":{"size":11}},{"textwrap":true},{"textwrap":false},{"color":"#ffffff","bgcolor":"#ad2177","textwrap":true},{"color":"#ffffff","bgcolor":"#ad2177","textwrap":true,"align":"center"},{"color":"#ffffff","bgcolor":"#ad2177","textwrap":true,"align":"center","font":{"size":11}},{"font":{"size":9}},{"align":"center","valign":"middle","font":{"bold":true},"border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"bgcolor":"#ad2177","font":{"bold":true,"size":16},"color":"#ffffff","align":"center","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"bgcolor":"#ad2177","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"align":"center","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"bgcolor":"#ad2177","align":"center","color":"#ffffff","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"color":"#ffffff","bgcolor":"#ad2177","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"bgcolor":"#ad2177","align":"center","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"bgcolor":"#ad2177","font":{"size":12},"color":"#ffffff","align":"center","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"bgcolor":"#ad2177","font":{"size":14},"color":"#ffffff","align":"center","border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"align":"center","valign":"middle","bgcolor":"#ad2177","color":"#ffffff","textwrap":true,"font":{"size":11},"border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"color":"#ffffff","bgcolor":"#ad2177","textwrap":true,"align":"center","font":{"size":11},"border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"textwrap":false,"border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"font":{"size":9},"border":{"bottom":["thin","#ad2177"],"top":["thin","#ad2177"],"left":["thin","#ad2177"],"right":["thin","#ad2177"]}},{"align":"center","valign":"middle","font":{"bold":true},"border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"bgcolor":"#ad2177","font":{"bold":true,"size":16},"color":"#ffffff","align":"center","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"bgcolor":"#ad2177","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"align":"center","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"bgcolor":"#ad2177","align":"center","color":"#ffffff","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"color":"#ffffff","bgcolor":"#ad2177","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"bgcolor":"#ad2177","align":"center","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"bgcolor":"#ad2177","font":{"size":12},"color":"#ffffff","align":"center","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"bgcolor":"#ad2177","font":{"size":14},"color":"#ffffff","align":"center","border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"align":"center","valign":"middle","bgcolor":"#ad2177","color":"#ffffff","textwrap":true,"font":{"size":11},"border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"color":"#ffffff","bgcolor":"#ad2177","textwrap":true,"align":"center","font":{"size":11},"border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"textwrap":false,"border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"font":{"size":9},"border":{"bottom":["thin","#000100"],"top":["thin","#000100"],"left":["thin","#000100"],"right":["thin","#000100"]}},{"border":{"bottom":["thin","#000"],"top":["thin","#000"],"left":["thin","#000"],"right":["thin","#000"]}}],"merges":["A1:A2","B1:J2","A3:B3","C3:E3","H3:J3","A4:B4","C4:E4","H4:J4","A5:B5","A6:B6","C5:E5","C6:E6","F5:G5","F6:G6","H5:J5","H6:J6","F3:G4","A7:J7","A8:J8","A9:J9","A10:J10","A11:J11","A12:J12","A13:J13","A14:J14","A15:J15","A16:J16","A17:J17","A18:J18","A19:A20","A21:A22","A23:A24","A25:A26","A27:A28","B19:F19","B20:F20","B21:F21","B22:F22","B23:F23","B24:F24","B25:F25","B26:F26","B27:F27","B28:F28","G19:H19","G20:H20","G21:H21","G22:H22","G23:H23","G24:H24","G25:H25","G26:H26","G27:H27","G28:H28","I19:J19","I20:J20","I21:J21","I22:J22","I23:J23","I24:J24","I25:J25","I26:J26","I27:J27","I28:J28","A30:J30","A31:J31","A32:J32","A33:J33","B34:J34","B35:J35","B36:J36","B37:J37","B38:J38","A39:J39","A40:J41","I42:J42","I43:J43","I44:J44","I45:J45","G42:H42","G43:H43","G44:H44","G45:H45","A42:F42","A43:F43","A44:F44","A45:F45","A46:J46","A47:J47","A48:J48","A49:J49","A50:J50","A51:J51","A52:J52","A53:J54","A55:J55","A56:J56","A57:J57","A58:J58","A59:J59","A60:J60","A61:J61","A62:J62","A63:J63","A64:J64","A29:J29"],"rows":{"0":{"cells":{"0":{"merge":[1,0],"style":54,"text":"LOGO"},"1":{"style":55,"merge":[1,8],"text":"SUNOIDA ROOT CAUSE ANALYSIS (RCA) REPORT"},"2":{"style":18},"3":{"style":18},"4":{"style":18},"5":{"style":18},"6":{"style":18},"7":{"style":18},"8":{"style":18},"9":{"style":18}}},"1":{"cells":{"0":{"style":2},"1":{"style":56},"2":{"style":56},"3":{"style":56},"4":{"style":56},"5":{"style":56},"6":{"style":56},"7":{"style":56},"8":{"style":56},"9":{"style":56}}},"2":{"cells":{"0":{"merge":[0,1],"text":"RCA Number","style":57},"1":{"style":0},"2":{"merge":[0,2],"style":58},"5":{"merge":[1,1],"text":"Team Members","style":57},"6":{"style":0},"7":{"merge":[0,2],"style":58}}},"3":{"cells":{"0":{"merge":[0,1],"text":"Product Name","style":57},"1":{"style":0},"2":{"merge":[0,2],"style":58},"5":{"style":57},"6":{"style":57},"7":{"merge":[0,2],"style":58}}},"4":{"cells":{"0":{"merge":[0,1],"text":"Module Name","style":57},"1":{"style":0},"2":{"merge":[0,2],"style":58},"5":{"merge":[0,1],"text":"Verified By","style":57},"6":{"style":0},"7":{"merge":[0,2],"style":58}}},"5":{"cells":{"0":{"merge":[0,1],"text":"Date & Time Ticket Raised","style":57},"1":{"style":0},"2":{"merge":[0,2],"style":58},"5":{"merge":[0,1],"text":"Approved By","style":57},"6":{"style":0},"7":{"merge":[0,2],"style":58}}},"6":{"cells":{"0":{"style":59,"merge":[0,9],"text":"EXPLAIN THE PROBLEM"},"1":{"style":19},"2":{"style":19},"3":{"style":19},"4":{"style":19},"5":{"style":19},"6":{"style":19},"7":{"style":19},"8":{"style":19},"9":{"style":19}}},"7":{"cells":{"0":{"merge":[0,9],"style":58}}},"8":{"cells":{"0":{"merge":[0,9],"style":58}}},"9":{"cells":{"0":{"merge":[0,9],"style":58}}},"10":{"cells":{"0":{"merge":[0,9],"style":58}}},"11":{"cells":{"0":{"merge":[0,9],"style":58}}},"12":{"cells":{"0":{"merge":[0,9],"text":"Resolution : ","style":60},"1":{"style":20},"2":{"style":20},"3":{"style":20},"4":{"style":20},"5":{"style":20},"6":{"style":20},"7":{"style":20},"8":{"style":20},"9":{"style":20}}},"13":{"cells":{"0":{"merge":[0,9],"style":58}}},"14":{"cells":{"0":{"merge":[0,9],"style":58}}},"15":{"cells":{"0":{"merge":[0,9],"style":58}}},"16":{"cells":{"0":{"merge":[0,9],"style":58}}},"17":{"cells":{"0":{"merge":[0,9],"style":56},"1":{"style":18},"2":{"style":18},"3":{"style":18},"4":{"style":18},"5":{"style":18},"6":{"style":18},"7":{"style":18},"8":{"style":18},"9":{"style":18}}},"18":{"cells":{"0":{"merge":[1,0],"style":61,"text":"D"},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"19":{"cells":{"0":{"style":21},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"20":{"cells":{"0":{"style":61,"merge":[1,0],"text":"M"},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"21":{"cells":{"0":{"style":61},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"22":{"cells":{"0":{"style":61,"merge":[1,0],"text":"A"},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"23":{"cells":{"0":{"style":21},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"24":{"cells":{"0":{"style":61,"merge":[1,0],"text":"I"},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"25":{"cells":{"0":{"style":61},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"26":{"cells":{"0":{"style":61,"merge":[1,0],"text":"C"},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"27":{"cells":{"0":{"style":21},"1":{"merge":[0,4],"style":58},"6":{"merge":[0,1],"style":58},"8":{"merge":[0,1],"style":58}}},"28":{"cells":{"0":{"style":68,"merge":[0,9]}}},"29":{"cells":{"0":{"merge":[0,9],"style":58}}},"30":{"cells":{"0":{"merge":[0,9],"style":62,"text":"SUNOIDA ROOT CAUSE ANALYSIS (RCA) REPORT"},"1":{"style":26,"text":""},"2":{"style":26,"text":""},"3":{"style":26,"text":""},"4":{"style":26,"text":""},"5":{"style":26,"text":""},"6":{"style":26,"text":""},"7":{"style":26,"text":""},"8":{"style":26,"text":""},"9":{"style":26}}},"31":{"cells":{"0":{"text":"RISK REDUCTION ACTIONS TAKEN ","style":59,"merge":[0,9]},"1":{"style":14},"2":{"style":14},"3":{"style":14},"4":{"style":14},"5":{"style":14},"6":{"style":14},"7":{"style":14},"8":{"style":14},"9":{"style":14}}},"32":{"cells":{"0":{"style":59,"merge":[0,9],"text":"List the actions that have already been taken to reduce the risk of a future occurrence. Note the date of implementation."},"1":{"style":14},"2":{"style":14},"3":{"style":14},"4":{"style":14},"5":{"style":14},"6":{"style":14},"7":{"style":14},"8":{"style":14},"9":{"style":14}}},"33":{"cells":{"0":{"style":59,"text":"Date"},"1":{"style":59,"merge":[0,8],"text":"Details of the action taken"},"2":{"style":14},"3":{"style":14},"4":{"style":14},"5":{"style":14},"6":{"style":14},"7":{"style":14},"8":{"style":14},"9":{"style":14}}},"34":{"cells":{"0":{"style":58},"1":{"merge":[0,8],"style":58}}},"35":{"cells":{"0":{"style":58},"1":{"style":58,"merge":[0,8]}}},"36":{"cells":{"0":{"style":58},"1":{"style":58,"merge":[0,8]}}},"37":{"cells":{"0":{"style":58},"1":{"style":58,"merge":[0,8]}}},"38":{"cells":{"0":{"merge":[0,9],"style":63,"text":"PREVENTION STRATEGIES "},"1":{"style":28},"2":{"style":28},"3":{"style":28},"4":{"style":28},"5":{"style":28},"6":{"style":28},"7":{"style":28},"8":{"style":28},"9":{"style":28}}},"39":{"cells":{"0":{"merge":[1,9],"text":"List the recommended actions planned to prevent a future occurrence of the adverse event. Begin with a rank of 1 (highest). Provide an ffort (if known) and any additional considerations\/recommendations for implementing the strategy.","style":64},"1":{"style":33},"2":{"style":33},"3":{"style":33},"4":{"style":33},"5":{"style":33},"6":{"style":33},"7":{"style":33},"8":{"style":33},"9":{"style":33}}},"40":{"cells":{"0":{"style":33},"1":{"style":33},"2":{"style":33},"3":{"style":33},"4":{"style":33},"5":{"style":33},"6":{"style":33},"7":{"style":33},"8":{"style":33},"9":{"style":33}}},"41":{"cells":{"0":{"merge":[0,5],"text":"STRATEGY","style":57},"1":{"style":0},"2":{"style":0},"3":{"style":0},"4":{"style":0},"5":{"style":0},"6":{"merge":[0,1],"text":" EFFORT","style":57},"7":{"style":0},"8":{"merge":[0,1],"text":"SPECIAL CONSIDERATIONS","style":57},"9":{"style":0}}},"42":{"cells":{"0":{"style":58,"merge":[0,5]},"6":{"style":58,"merge":[0,1]},"8":{"style":58,"merge":[0,1]}}},"43":{"cells":{"0":{"style":58,"merge":[0,5]},"6":{"style":58,"merge":[0,1]},"8":{"style":58,"merge":[0,1]}}},"44":{"cells":{"0":{"style":58,"merge":[0,5]},"6":{"style":58,"merge":[0,1]},"8":{"style":58,"merge":[0,1]}}},"45":{"cells":{"0":{"merge":[0,9],"text":"INCIDENTAL FINDINGS","style":59},"1":{"style":19},"2":{"style":19},"3":{"style":19},"4":{"style":19},"5":{"style":19},"6":{"style":19},"7":{"style":19},"8":{"style":19},"9":{"style":19}}},"46":{"cells":{"0":{"merge":[0,9],"text":"List and explain any incidental findings that should be carefully reviewed for corrective action.","style":59},"1":{"style":19},"2":{"style":19},"3":{"style":19},"4":{"style":19},"5":{"style":19},"6":{"style":19},"7":{"style":19},"8":{"style":19},"9":{"style":19}}},"47":{"cells":{"0":{"merge":[0,9],"style":58}}},"48":{"cells":{"0":{"style":58,"merge":[0,9]}}},"49":{"cells":{"0":{"style":58,"merge":[0,9]}}},"50":{"cells":{"0":{"style":58,"merge":[0,9]}}},"51":{"cells":{"0":{"merge":[0,9],"text":"APPROVAL","style":59},"1":{"style":19},"2":{"style":19},"3":{"style":19},"4":{"style":19},"5":{"style":19},"6":{"style":19},"7":{"style":19},"8":{"style":19},"9":{"style":19}}},"52":{"cells":{"0":{"merge":[1,9],"style":65,"text":"After review of this summary report, all team members should notify the team leader of either their approval or recommendations  for revision.  Following all revisions the report should be signed by the team leader prior to submission."},"1":{"style":38},"2":{"style":38},"3":{"style":38},"4":{"style":38},"5":{"style":38},"6":{"style":38},"7":{"style":38},"8":{"style":38},"9":{"style":38}}},"53":{"cells":{"0":{"style":38},"1":{"style":38},"2":{"style":38},"3":{"style":38},"4":{"style":38},"5":{"style":38},"6":{"style":38},"7":{"style":38},"8":{"style":38},"9":{"style":38}}},"54":{"cells":{"0":{"style":66,"merge":[0,9]}}},"55":{"cells":{"0":{"style":66,"merge":[0,9]}}},"56":{"cells":{"0":{"style":66,"merge":[0,9]}}},"57":{"cells":{"0":{"style":66,"merge":[0,9]}}},"58":{"cells":{"0":{"style":59,"merge":[0,9],"text":"All information included in this report is considered confidential. It is intended only to promote safety and reduce risk."},"1":{"style":14},"2":{"style":14},"3":{"style":14},"4":{"style":14},"5":{"style":14},"6":{"style":14},"7":{"style":14},"8":{"style":14},"9":{"style":14}}},"59":{"cells":{"0":{"merge":[0,9],"text":"Forward completed report to all Root Cause Analysis team members in addition to the following individuals:","style":67},"1":{"style":39},"2":{"style":39},"3":{"style":39},"4":{"style":39},"5":{"style":39},"6":{"style":39},"7":{"style":39},"8":{"style":39},"9":{"style":39}}},"60":{"cells":{"0":{"style":58,"merge":[0,9],"text":"Director - Support Head"}}},"61":{"cells":{"0":{"style":58,"merge":[0,9],"text":"Director - Product Implementation and R& D"}}},"62":{"cells":{"0":{"style":58,"merge":[0,9],"text":"PMO Head"}}},"63":{"cells":{"0":{"style":58,"merge":[0,9],"text":"Knowledge Base Maintenance Team"}}},"len":101},"cols":{"len":26},"validations":[],"autofilter":{}
            });

            // spreadsheet.change(function (data) {
            //     console.log("Spreadsheet data changed:", data);
            // });

            


            $('#saveButton').click(function (e) {
                e.preventDefault(); // Prevent default form submission behavior
                console.log("Full Save clicked.");

                const sheetData = spreadsheet.getData(); // Collect data from the spreadsheet
                console.log("Full Data to Save:", sheetData); // Log the collected data for debugging

                $.ajax({
                    url: '<?= base_url('savesheet') ?>', // Update to your backend endpoint
                    type: 'POST',
                     contentType: 'application/json', // Specify content type as JSON
                    data: JSON.stringify({ data: sheetData }), // Convert data to JSON string
                   
                    success: function (response) {
                        console.log('Save Successfully', response); // Log the success response
                        alert('Sheet Save Successfully');
                    },
                    error: function (xhr, status, error) {
                        console.error('Error saving data:', error); // Log the error for debugging
                        alert('Failed to save data. Please try again.');
                    }
                });
            });


            $('#partialSaveButton').click(function () {
                console.log("Partial Save clicked.");
                const partialData = spreadsheet.getData();
                console.log("Partial Data to Save:", partialData);
            });

        } catch (error) {
            console.error("Spreadsheet initialization failed:", error);
        }
    });
</script>
